# Development docker-compose override
# Use this for development with live reload
# Usage: docker-compose -f docker-compose.yml -f docker-compose.dev.yml up
# Or simply: ./scripts/dev.sh

version: '3.8'

services:
  web:
    volumes:
      # Mount source code for live editing
      - ./server:/app/server:ro
      # Preserve node_modules from image (don't override)
      - /app/node_modules
    # Use tsx watch for auto-reload on code changes
    command: sh -c "npm run migrate && npm run dev"

  worker:
    volumes:
      # Mount source code for live editing
      - ./server:/app/server:ro
      # Preserve node_modules from image (don't override)
      - /app/node_modules
    # Worker uses tsx watch via RUN_MODE=worker
    command: npm run dev

  # Frontend uses built static files in dev mode
  # For frontend development with hot reload, run: cd client && npm start
  # The frontend container serves the built static files
